setwd("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis")
library(corrr)
# select A LOT of continuous features
for_factor <- students[,c(1,863,887,895,896,898,900,903,904,872,873,874,875,879,880,883,884,888,889,890,891,892,899,905,908,935)]
# select A LOT of continuous features
students <- get(load('students.RData'))
rm(df)
for_factor <- students[,c(1,863,887,895,896,898,900,903,904,872,873,874,875,879,880,883,884,888,889,890,891,892,899,905,908,935)]
View(students)
View(students)
load("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis/df_processed.RData")
load("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis/datenere.RData")
load("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis/df_processed.RData")
load("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis/dfITA_processed.RData")
load("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis/students.RData")
View(da.tenere)
dfITA <- get(load('datenere'))
dfITA <- get(load('datenere.RData'))
dfITA <- get(load('datenere.RData'))
rm(da.tenere)
dim(dfITA)
head(dfITA)
x11()
plot(dfITA)
nrows(dfITA)
n <- dim(dfITA)[1]
p <- dim(dfITA)[2]
for(j in 1:p)
df[,j] <- df[,j] + cbind(rnorm(n, sd=0.025))
dfITA <- data.frame(dfITA)
for(j in 1:p)
df[,j] <- df[,j] + cbind(rnorm(n, sd=0.025))
for(j in 1:p)
dfITA[,j] <- dfITA[,j] + cbind(rnorm(n, sd=0.025))
head(dfITA)
dfITA <- get(load('datenere.RData'))
head(dfITA)
for(j in 1:p)
dfITA[,j] <- dfITA[,j] + cbind(rnorm(n, sd=0.0025))
head(dfITA)
library(mvtnorm)
library(MVN)
library(rgl)
library(car)
library(dbscan)
library(cluster)
library(fields)
library(ggplot2)
set.seed(040523)
# standardize data
features <- scale(dfITA)
# compute dissimilarity matrix
Dmat_e <- dist(features, method='euclidean')
# compute clustering structure
eucl_single <- hclust(Dmat_e, method='single')
eucl_avg <- hclust(Dmat_e, method='average')
eucl_compl <- hclust(Dmat_e, method='complete')
x11()
par(mfrow=c(1,3))
plot(eucl_single, main='euclidean-single', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
plot(eucl_avg, main='euclidean-average', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
plot(eucl_compl, main='euclidean-complete', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
#
# cut at 2
rect.hclust(eucl_compl, k=2)
cluster.ec2 <- cutree(eucl_compl, k=2)
p
x11()
par(mfrow=c(2,4))
for(j in 1:p)
plot(features[,j], col = cluster.ec3+1)
x11()
par(mfrow=c(2,4))
for(j in 1:p)
plot(features[,j], col = cluster.ec2+1)
eucl_ward <- hclust(Dmat_e, method='ward')
eucl_ward <- hclust(Dmat_e, method='ward.D')
x11()
par(mfrow=c(1,4))
plot(eucl_single, main='euclidean-single', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
plot(eucl_avg, main='euclidean-average', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
plot(eucl_compl, main='euclidean-complete', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
plot(eucl_ward, main='euclidean-ward', hang=-0.1, xlab='', labels=F, cex=0.6, sub='')
#
# cut at 2
rect.hclust(eucl_ward, k=2)
cluster.ew2 <- cutree(eucl_ward, k=2)
x11()
par(mfrow=c(2,4))
for(j in 1:p)
plot(features[,j], col = cluster.ew2+1)
coph.es <- cophenetic(eucl_single)
coph.ec <- cophenetic(eucl_compl)
coph.ea <- cophenetic(eucl_avg)
coph.ew <- cophenetic(eucl_ward)
# compute cophenetic coefficients
es <- cor(eucl_single, coph.es)
ea <- cor(eucl_avg, coph.ea)
ec <- cor(eucl_compl, coph.ec)
ew <- cor(eucl_ward, coph.ew)
# compute cophenetic coefficients
es <- cor(Dmat_e, coph.es)
ea <- cor(Dmat_e, coph.ea)
ec <- cor(Dmat_e, coph.ec)
ew <- cor(Dmat_e, coph.ew)
es
ea
ec
ew
setwd("//wsl.localhost/Ubuntu/home/bzamboni/progetto applied/PISA-analysis")
